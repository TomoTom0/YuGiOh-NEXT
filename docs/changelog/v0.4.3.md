# v0.4.3 変更履歴

リリース日: 2025-11-27

## 改善

### キャッシュシステムの改善

#### CardTableB構造の拡張
キャッシュDBのCardTableBに以下のフィールドを追加し、カード情報の保存をより完全にしました：
- **linkMarkers**: リンクモンスターのリンクマーカー情報
- **pendulumText**: ペンデュラムモンスターのペンデュラム効果テキスト

これにより、リンクモンスターとペンデュラムモンスターの情報がキャッシュから完全に復元できるようになりました。

#### カード詳細取得ロジックの修正
`card-info-cache.md`の仕様に従って、カード詳細取得ロジックを修正：
- キャッシュからの復元時に必要な情報が欠落しないように改善
- UnifiedCacheDBとの整合性を強化

### UI/UX改善

#### デッキレイアウトのデフォルト変更
Extra/Sideセクションの配置デフォルトを**横並び（horizontal）から縦並び（vertical）**に変更しました。
- より多くのカードを一度に表示可能
- スクロール量の削減

#### キーボードショートカット設定の改善
キーボードショートカット設定ダイアログを大幅に改善：
- **リアルタイムプレビュー**: 入力中のキーの組み合わせを即座に表示
- **競合検出**: 既に使用されているショートカットキーを警告
- **修飾キーの視覚化**: Ctrl/Shift/Alt/Metaキーの状態を明確に表示
- **より直感的なUI**: Material Designに準拠したデザイン

### バグ修正

#### Extra/Sideセクションの高さ問題を修正
デッキ編集画面のExtra/Sideセクションで発生していた高さ関連の問題を修正：
- `overflow: visible`を追加して、カードが切れて表示される問題を解消
- `align-items`を適切に設定して、セクション間の配置を改善
- レイアウト全体の安定性を向上

#### Rush Duelのproductsタブ問題を修正
Rush DuelカードのProductsタブでカード一覧が空白になる問題を修正しました。

### リファクタリング

#### CardProducts.vueのアーキテクチャ改善
CardProducts.vueのコード構造を改善：
- パック検索ロジックを`card-search.ts`に移動
- コンポーネントの責務を明確化
- メンテナンス性の向上

## 技術的詳細

### 修正ファイル
- `src/api/card-search.ts`: カード詳細取得ロジック修正、searchCardsByPackId追加
- `src/components/CardProducts.vue`: アーキテクチャ改善
- `src/components/CardInfo.vue`: pendulumText表示対応
- `src/components/CardList.vue`: linkMarkers表示対応
- `src/components/DeckSection.vue`: Extra/Side高さ問題修正
- `src/content/edit-ui/DeckEditLayout.vue`: レイアウト改善
- `src/options/components/KeyInputDialog.vue`: キーボードショートカット設定UI改善
- `src/options/components/tabs/GeneralTab.vue`: ショートカット設定統合
- `src/stores/settings.ts`: middleDecksLayoutデフォルト変更
- `src/types/card.ts`: CardTableB型定義更新
- `src/types/settings.ts`: 設定型定義更新
- `src/utils/unified-cache-db.ts`: linkMarkers/pendulumText保存対応

### コミット数
9件のコミット

## ドキュメント更新

- `docs/design/cache-db.md`: CardTableB構造更新
- `docs/design/search-condition.md`: 検索条件設計ドキュメント追加

## 既知の問題

特になし

## 次バージョンの予定

- 検索フィルターの改善
- カード詳細の段階的取得機能
- TempCardDB自動保存機能
