# v0.5.5 (2025-12-08)

## 新機能

### 検索履歴機能
- 検索履歴タブを検索条件ダイアログに追加
- お気に入り検索の保存・実行
- 最近の検索履歴の表示
- 検索結果件数の表示
- localStorage による永続化

## リファクタリング

### 検索状態の一元管理
- `src/stores/search.ts` を新規作成し、全検索状態を集約
  - `searchQuery`, `searchResults`, `searchFilters` など
  - `isLoading`, `hasMore`, `currentPage` など
- `deck-edit.ts` から検索関連の状態を削除（単一責任の原則）
- 全コンポーネントが `useSearchStore` を使用するように統一

### コード削減
- SearchInputBar から重複した `handleSearch` を削除（200行削減）
- `useSearchExecution` composable に統一
- コードの可読性と保守性が向上

## UI改善

### SearchFilterDialog
- フッターを固定配置（`position: sticky`）
- ダイアログ高さを 85vh → 90vh に拡大
- SearchInputBar と閉じるボタンをフッターに配置
- フッターの余白を調整（`padding: 8px`, `gap: 8px`）

### チップスタイルの統一
- 全箇所で統一されたスタイル：
  - `font-size: 11px`（従来 8px～10px）
  - `padding: 2px 6px`（従来 1px 3px）
  - `border-radius: 3px`（従来 2px）
  - `max-width: 80px`（従来 48px～64px）
  - `line-height: 1.3`
- 対象箇所：
  - SearchFilterDialog ヘッダーチップ
  - SearchFilterDialog 履歴チップ
  - SearchInputBar フィルターチップ

## 修正

### 検索機能
- `hasActiveFilters` が正しく動作するように修正
  - 検索フィルターの状態を直接参照
  - computed プロパティで動的に計算
- 検索履歴が正常に保存されるように修正
  - `useSearchExecution` で `searchHistory.addToHistory()` を呼び出し

### Auto検索モードの改善
- 2文字以下の検索を name 検索に委譲
- 100件取得時に name 検索に切り替えて追加取得
- ソート順を有効化

## 技術的詳細

### 新規ファイル
- `src/stores/search.ts` - 検索専用 Pinia store
- `src/composables/useSearchHistory.ts` - 検索履歴管理 composable
- `src/types/search-history.ts` - 検索履歴の型定義

### 変更ファイル
- `src/components/SearchFilterDialog.vue` - タブ追加、フッター固定
- `src/components/searchInputBar/SearchInputBar.vue` - 重複コード削除
- `src/components/searchInputBar/composables/useSearchExecution.ts` - store使用に変更
- `src/components/searchInputBar/composables/useMydeckOperations.ts` - store使用に変更
- `src/components/searchInputBar/components/SearchFilterChips.vue` - スタイル統一
- `src/components/RightArea.vue` - searchStore 使用
- `src/content/edit-ui/DeckEditLayout.vue` - searchStore 使用
- `src/stores/deck-edit.ts` - 検索状態削除

### 影響範囲
- 検索関連の全コンポーネント
- 状態管理の構造変更
- UI/UX の改善

## コミット履歴

### 9390d17 - refactor: 検索状態を専用storeに移行、UIを改善
- 検索状態の一元管理
- UI改善（フッター固定、チップスタイル統一）
- コード削減（200行）

### 58b41b7 - feat: 検索履歴機能の追加（WIP）
- 検索履歴タブUI実装
- useSearchHistory composable 作成
- お気に入り機能実装
