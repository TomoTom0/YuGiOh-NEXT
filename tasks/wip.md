# WIP

現在作業中のタスク（進行中）

## 現在の状態（2025-11-06 更新）

### ✅ 完了: カード情報スクレイピング機能の完全実装と検証

#### Phase 1完了内容
1. **マップ定義方式の採用**
   - types/card-maps.ts作成
   - 属性、種族、タイプ、効果種類の識別子定義
   - `as const`と`keyof typeof`による型自動生成

2. **型定義の完全更新**
   - CardBase, MonsterCard, SpellCard, TrapCard
   - 識別子ベースのフィールド
   - ペンデュラム情報、ciid、imgHash追加

3. **完全なパーサー実装**
   - HTMLテキスト→識別子への変換処理
   - 構造ベースの判定（DOM要素の構造から情報を抽出）
   - JavaScriptコードからのciid/imgHash抽出
   - ペンデュラム情報の取得
   - エラーハンドリング（未知の値の警告）

4. **検証完了**
   - 日本語モードでの動作確認
   - 全カードタイプでのテスト（レベル、ランク、リンク、ペンデュラム、魔法、罠）
   - マップ定義の完全性確認（未知の値なし）
   - 全フィールドの取得確認（ciid, imgHash, pendulum情報すべて成功）

5. **ビルドとデプロイ成功**

---

## 🎯 次のアクション

### 優先度: 高

#### リンクモンスター対応（残タスク）
- [ ] リンク数の取得方法調査
- [ ] 実装とテスト

### 優先度: 中

#### テストの整備
- [ ] マップ変換のユニットテスト作成
- [ ] パーサー関数のユニットテスト更新
- [ ] 実際のHTMLを使った統合テスト

#### ドキュメント更新
- [ ] card-maps.tsにコメント追加（各識別子の説明）
- [ ] APIドキュメントの更新

---

## 📝 参考ドキュメント

- `tmp/wip/card-scraping-proposal-v3.md` - 実装の設計仕様
- `types/card-maps.ts` - マップ定義
- `types/card.ts` - 型定義
- `api/card-search.ts` - パーサー実装
